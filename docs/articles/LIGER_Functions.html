<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LIGER Plotting &amp; Functionality • scCustomize</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="LIGER Plotting &amp; Functionality">
<meta property="og:description" content="scCustomize">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scCustomize</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Getting Started</a>
</li>
<li>
  <a href="../articles/Installation.html">Install</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Plotting Vignettes</li>
    <li>
      <a href="../articles/Gene_Expression_Plotting.html">Plotting #1: Analysis Plots</a>
    </li>
    <li>
      <a href="../articles/QC_Plots.html">Plotting #2: QC Plots</a>
    </li>
    <li>
      <a href="../articles/Sequencing_QC_Plots.html">Plotting #3: Sequencing QC Plots/Analysis</a>
    </li>
    <li>
      <a href="../articles/Iterative%20Plotting.html">Plotting #4: Iterative Plotting Functions</a>
    </li>
    <li>
      <a href="../articles/Color_Palettes.html">Customized Color Palettes &amp; Themes</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Helpers &amp; Utilities</li>
    <li>
      <a href="../articles/Read_and_Write_Functions.html">Read &amp; Write Data Functions</a>
    </li>
    <li>
      <a href="../articles/Markers_and_Cluster_Annotation.html">Marker Identification &amp; Cluster Annotation Helpers</a>
    </li>
    <li>
      <a href="../articles/Statistics.html">Statistics Functions</a>
    </li>
    <li>
      <a href="../articles/Helpers_and_Utilities.html">General Helpers &amp; Utilities</a>
    </li>
    <li>
      <a href="../articles/Misc_Functions.html">Misc Functions</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Other Package Interactivity/Functions</li>
    <li>
      <a href="../articles/LIGER_Functions.html">LIGER Plotting &amp; Functionality</a>
    </li>
    <li>
      <a href="../articles/Cell_Bender_Functions.html">Cell Bender Functionality &amp; Plotting</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News/Changelog</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/FAQ.html">FAQ</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/samuel-marsh/scCustomize/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="LIGER_Functions_files/header-attrs-2.11/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>LIGER Plotting &amp; Functionality</h1>
            
            <h4 class="date">Compiled: November 17, 2021</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/samuel-marsh/scCustomize/blob/master/vignettes/LIGER_Functions.Rmd"><code>vignettes/LIGER_Functions.Rmd</code></a></small>
      <div class="hidden name"><code>LIGER_Functions.Rmd</code></div>

    </div>

    
    
<hr>
<style>
p.caption {
  font-size: 0.9em;
}
</style>
<div id="interavtivity-with-liger-objects" class="section level1">
<h1 class="hasAnchor">
<a href="#interavtivity-with-liger-objects" class="anchor"></a>Interavtivity with LIGER Objects</h1>
<p>While the majority of scCustomize’s current functionality is with Seurat Objects there are a few functions for working with LIGER objects too.</p>
<p>For this tutorial, I will be utilizing microglia data from Marsh et al., 2020 (<a href="https://www.biorxiv.org/content/10.1101/2020.12.03.408542v1"><em>bioRxiv</em></a>) which I have converted to LIGER object.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load Packages</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://satijalab.org/seurat">Seurat</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/welch-lab/liger">rliger</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/samuel-marsh/scCustomize">scCustomize</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/traversc/qs">qs</a></span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># read object</span>
<span class="va">marsh_micro</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/qs/man/qread.html">qread</a></span><span class="op">(</span><span class="st">"assets/marsh_2020_micro.qs"</span><span class="op">)</span>

<span class="co"># Convert to liger</span>
<span class="va">marsh_liger</span> <span class="op">&lt;-</span> <span class="fu">liger</span><span class="fu">::</span><span class="fu">seuratToLiger</span><span class="op">(</span>objects <span class="op">=</span> <span class="va">marsh_micro</span>, combined.seurat <span class="op">=</span> <span class="cn">TRUE</span>, use.idents <span class="op">=</span> <span class="cn">T</span>,
    use.tsne <span class="op">=</span> <span class="cn">T</span>, meta.var <span class="op">=</span> <span class="st">"orig.ident"</span>, remove.missing <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># Add meta data to LIGER \@cell.data slot</span>
<span class="va">marsh_liger</span><span class="op">@</span><span class="va">cell.data</span><span class="op">$</span><span class="va">Transcription</span> <span class="op">&lt;-</span> <span class="va">marsh_micro</span><span class="op">@</span><span class="va">meta.data</span><span class="op">$</span><span class="va">Transcription</span>
<span class="va">marsh_liger</span><span class="op">@</span><span class="va">cell.data</span><span class="op">$</span><span class="va">Method</span> <span class="op">&lt;-</span> <span class="va">marsh_micro</span><span class="op">@</span><span class="va">meta.data</span><span class="op">$</span><span class="va">Method</span>
<span class="va">marsh_liger</span><span class="op">@</span><span class="va">cell.data</span><span class="op">$</span><span class="va">Batch</span> <span class="op">&lt;-</span> <span class="va">marsh_micro</span><span class="op">@</span><span class="va">meta.data</span><span class="op">$</span><span class="va">Batch</span>
<span class="va">marsh_liger</span><span class="op">@</span><span class="va">cell.data</span><span class="op">$</span><span class="va">Transcription_Method</span> <span class="op">&lt;-</span> <span class="va">marsh_micro</span><span class="op">@</span><span class="va">meta.data</span><span class="op">$</span><span class="va">Transcription_Method</span></code></pre></div>
<div id="dimensionality-reduction-plotting" class="section level2">
<h2 class="hasAnchor">
<a href="#dimensionality-reduction-plotting" class="anchor"></a>Dimensionality Reduction Plotting</h2>
<p>scCustomize contains new LIGER plotting function <code>DimPlot_LIGER</code> that both adds functionality not present in LIGER package and provides function for plotting that is easier to use for those more familiar with Seurat’s <code>DimPlot</code></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/DimPlot_LIGER.html">DimPlot_LIGER</a></span><span class="op">(</span>liger_object <span class="op">=</span> <span class="va">marsh_liger</span><span class="op">)</span></code></pre></div>
<p><img src="LIGER_Functions_files/figure-html/unnamed-chunk-3-1.png" width="576" style="display: block; margin: auto;"></p>
<p>As you can see we get plot that looks very similar to thought generated by <code>DimPlot_scCustom</code> or <code><a href="https://satijalab.org/seurat/reference/DimPlot.html">Seurat::DimPlot</a></code>.</p>
<div id="important-axes-labels" class="section level4">
<h4 class="hasAnchor">
<a href="#important-axes-labels" class="anchor"></a>/* IMPORTANT: AXES LABELS /*</h4>
<p>Unfortunately, the liger/rliger package does not properly store the name of the dimensionality reduction technique used and labels all plots with tSNE1/tSNE2 or dr1/dr2.</p>
<p><code>DimPlot_LIGER</code> solves this by providing extra parameter in the function that can be used to set labels. The first time you use <code>DimPlot_LIGER</code> in R session it will print a one-time message alerting you to the fact that this parameter exists and is set to “UMAP” by default (as it seems to be most commonly used method currently).</p>
<p>However, this analysis object used tSNE so let’s change that parameter.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/DimPlot_LIGER.html">DimPlot_LIGER</a></span><span class="op">(</span>liger_object <span class="op">=</span> <span class="va">marsh_liger</span>, reduction_label <span class="op">=</span> <span class="st">"tSNE"</span><span class="op">)</span></code></pre></div>
<p><img src="LIGER_Functions_files/figure-html/unnamed-chunk-4-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="optional-functionalityparameters" class="section level3">
<h3 class="hasAnchor">
<a href="#optional-functionalityparameters" class="anchor"></a>Optional functionality/Parameters</h3>
<p><code>DimPlot_LIGER</code> adds a number of options not present in liger plotting and modifies naming/functionality of others to be more in-line with Seurat for ease of use.</p>
</div>
<div id="plot-combination" class="section level3">
<h3 class="hasAnchor">
<a href="#plot-combination" class="anchor"></a>Plot combination</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/DimPlot_LIGER.html">DimPlot_LIGER</a></span><span class="op">(</span>liger_object <span class="op">=</span> <span class="va">marsh_liger</span>, reduction_label <span class="op">=</span> <span class="st">"tSNE"</span>, combination <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
<p><img src="LIGER_Functions_files/figure-html/unnamed-chunk-5-1.png" width="1248" style="display: block; margin: auto;"></p>
<p>User can specify different color palettes for each plot</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">clu_color</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ColorBlind_Pal.html">ColorBlind_Pal</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">sample_color</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DiscretePalette_scCustomize.html">DiscretePalette_scCustomize</a></span><span class="op">(</span>num_colors <span class="op">=</span> <span class="fl">12</span>, palette <span class="op">=</span> <span class="st">"alphabet"</span><span class="op">)</span>

<span class="fu"><a href="../reference/DimPlot_LIGER.html">DimPlot_LIGER</a></span><span class="op">(</span>liger_object <span class="op">=</span> <span class="va">marsh_liger</span>, reduction_label <span class="op">=</span> <span class="st">"tSNE"</span>, combination <span class="op">=</span> <span class="cn">T</span>, colors_use_cluster <span class="op">=</span> <span class="va">clu_color</span>,
    colors_use_meta <span class="op">=</span> <span class="va">sample_color</span><span class="op">)</span></code></pre></div>
<p><img src="LIGER_Functions_files/figure-html/unnamed-chunk-6-1.png" width="1248" style="display: block; margin: auto;"></p>
</div>
<div id="grouping-and-splitting-plots" class="section level3">
<h3 class="hasAnchor">
<a href="#grouping-and-splitting-plots" class="anchor"></a>Grouping and Splitting Plots</h3>
<p><code>DimPlot_LIGER</code> supports grouping and splitting plots by meta data variables or cluster and will return patchwork layout</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/DimPlot_LIGER.html">DimPlot_LIGER</a></span><span class="op">(</span>liger_object <span class="op">=</span> <span class="va">marsh_liger</span>, reduction_label <span class="op">=</span> <span class="st">"tSNE"</span>, group_by <span class="op">=</span> <span class="st">"Transcription_Method"</span>,
    colors_use_meta <span class="op">=</span> <span class="fu"><a href="../reference/JCO_Four.html">JCO_Four</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="LIGER_Functions_files/figure-html/unnamed-chunk-7-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/DimPlot_LIGER.html">DimPlot_LIGER</a></span><span class="op">(</span>liger_object <span class="op">=</span> <span class="va">marsh_liger</span>, reduction_label <span class="op">=</span> <span class="st">"tSNE"</span>, group_by <span class="op">=</span> <span class="st">"Cluster"</span>, split_by <span class="op">=</span> <span class="st">"Transcription_Method"</span>,
    label <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="LIGER_Functions_files/figure-html/unnamed-chunk-8-1.png" width="1152" style="display: block; margin: auto;"></p>
</div>
<div id="cluster-label-modification" class="section level3">
<h3 class="hasAnchor">
<a href="#cluster-label-modification" class="anchor"></a>Cluster Label Modification</h3>
<p><code>DimPlot_LIGER</code> supports many different modifications of cluster labels. <em>NOTE: labeling is only supported when plotting by cluster.</em></p>
<ul>
<li>
<code>label</code> logical. Whether to label clusters on plot.</li>
<li>
<code>label_size</code> Change label text size.</li>
<li>
<code>label_repel</code> logical. Whether to repel labels.</li>
<li>
<code>label_box</code> logical. Whether to place box around label.</li>
<li>
<code>label_color</code> change label text color.</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/DimPlot_LIGER.html">DimPlot_LIGER</a></span><span class="op">(</span>liger_object <span class="op">=</span> <span class="va">marsh_liger</span>, reduction_label <span class="op">=</span> <span class="st">"tSNE"</span><span class="op">)</span>
<span class="fu"><a href="../reference/DimPlot_LIGER.html">DimPlot_LIGER</a></span><span class="op">(</span>liger_object <span class="op">=</span> <span class="va">marsh_liger</span>, reduction_label <span class="op">=</span> <span class="st">"tSNE"</span>, label <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="../reference/DimPlot_LIGER.html">DimPlot_LIGER</a></span><span class="op">(</span>liger_object <span class="op">=</span> <span class="va">marsh_liger</span>, reduction_label <span class="op">=</span> <span class="st">"tSNE"</span>, label_repel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="../reference/DimPlot_LIGER.html">DimPlot_LIGER</a></span><span class="op">(</span>liger_object <span class="op">=</span> <span class="va">marsh_liger</span>, reduction_label <span class="op">=</span> <span class="st">"tSNE"</span>, label_repel <span class="op">=</span> <span class="cn">TRUE</span>, label_box <span class="op">=</span> <span class="cn">TRUE</span>,
    label_size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<p><img src="LIGER_Functions_files/figure-html/unnamed-chunk-10-1.png" width="1152" style="display: block; margin: auto;"></p>
</div>
<div id="raster-points" class="section level3">
<h3 class="hasAnchor">
<a href="#raster-points" class="anchor"></a>Raster Points</h3>
<p><code>DimPlot_LIGER</code> also supports point<sup>* </sup> rasterization utilizing scattermore package. <sup><sup></sup>Axes, labels, and legends will remain in vector form.</sup></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/DimPlot_LIGER.html">DimPlot_LIGER</a></span><span class="op">(</span>liger_object <span class="op">=</span> <span class="va">marsh_liger</span>, reduction_label <span class="op">=</span> <span class="st">"tSNE"</span>, raster <span class="op">=</span> <span class="cn">FALSE</span>, label <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="../reference/DimPlot_LIGER.html">DimPlot_LIGER</a></span><span class="op">(</span>liger_object <span class="op">=</span> <span class="va">marsh_liger</span>, reduction_label <span class="op">=</span> <span class="st">"tSNE"</span>, raster <span class="op">=</span> <span class="cn">TRUE</span>, label <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="LIGER_Functions_files/figure-html/unnamed-chunk-12-1.png" width="1152" style="display: block; margin: auto;"></p>
</div>
<div id="restore-ggplot2-default-color-scheme" class="section level3">
<h3 class="hasAnchor">
<a href="#restore-ggplot2-default-color-scheme" class="anchor"></a>Restore ggplot2 default color scheme</h3>
<p>If you would like to restore ggplot2 default color scheme but maintain the rest of the aesthetics of <code>DimPlot_LIGER</code> simply set parameter <code>ggplot_default_colors = TRUE</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/DimPlot_LIGER.html">DimPlot_LIGER</a></span><span class="op">(</span>liger_object <span class="op">=</span> <span class="va">marsh_liger</span>, reduction_label <span class="op">=</span> <span class="st">"tSNE"</span>, ggplot_default_colors <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="LIGER_Functions_files/figure-html/unnamed-chunk-13-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="customized-plotfactors-functionality" class="section level2">
<h2 class="hasAnchor">
<a href="#customized-plotfactors-functionality" class="anchor"></a>Customized plotFactors Functionality</h2>
<p><em>NOTE: For this example as “marsh_liger” was not originally a LIGER analyzed object it has no factors. So I ran a basic LIGER pipeline (with no specific parameters to demonstrate functionality of <code>Top_Genes_Factor</code>)</em></p>
<p>scCustomize contains function <code>plotFactors_scCustom</code> which expands the functionality and customizes the visualizes of LIGER’s <code>plotFactors</code> function.</p>
<div id="plots-created" class="section level3">
<h3 class="hasAnchor">
<a href="#plots-created" class="anchor"></a>Plots Created</h3>
<p><code>plotFactors_scCustom</code> returns two different plots for each iNMF factor. First, is plot of the factor loadings for each cell, grouped by dataset. The second is visualization of the factor loading on the dimensionality reduction coordinates.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">returned_plots</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">returned_plots</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span>

<span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html">wrap_plots</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="LIGER_Functions_files/figure-html/unnamed-chunk-16-1.png" width="1152" style="display: block; margin: auto;"></p>
</div>
<div id="additional-plot-savereturn-functionality" class="section level3">
<h3 class="hasAnchor">
<a href="#additional-plot-savereturn-functionality" class="anchor"></a>Additional Plot Save/Return Functionality</h3>
<p><code>plotFactors_scCustom</code> has a number of additional parameters that expand the functionality of <code>plotFactors</code>.</p>
<ul>
<li>
<code>save_plots</code> and/or <code>return_plots</code> logical parameters to either return plots to assigned variable in environment or save the plots to PDF (or both).</li>
<li>
<code>file_path</code> and <code>file_name</code> optional parameters required if saving plots to PDF.</li>
<li>
<code>raster</code> whether or not to raster the points in both plots. Significantly reduced PDF file size and speed of plotting.</li>
</ul>
</div>
<div id="additional-factor-plot-functionality" class="section level3">
<h3 class="hasAnchor">
<a href="#additional-factor-plot-functionality" class="anchor"></a>Additional Factor Plot Functionality</h3>
<p><code>plotFactors_scCustom</code> has a number of additional parameters that signifcantly expand the visualization options of <code>plotFactors</code>.</p>
<ul>
<li>
<code>colors_use_factors</code> can be used to color the datasets in the factor loading plot. Must be vector equal to or greater than number of datasets in object. By default uses the “varibow” palette from <code>DiscretePalette_scCustom</code> instead of default ggplot2 hue palette.<br>
</li>
<li>
<code>ggplot_default_colors</code> parameter can be specified if you would like to return this plot to using the ggplot2/hue palette.</li>
</ul>
<p><img src="LIGER_Functions_files/figure-html/unnamed-chunk-18-1.png" width="1152" style="display: block; margin: auto;"></p>
<ul>
<li>
<code>reorder_datasets</code> new order to plot datasets in. By default plots in factor level order from the <span class="citation">@cell.data</span> slot but this can be reordered just for plotting without changing the underlying object.</li>
</ul>
<p><img src="LIGER_Functions_files/figure-html/unnamed-chunk-20-1.png" width="1152" style="display: block; margin: auto;"></p>
</div>
<div id="added-dimensionality-reduction-functionality" class="section level3">
<h3 class="hasAnchor">
<a href="#added-dimensionality-reduction-functionality" class="anchor"></a>Added Dimensionality Reduction Functionality</h3>
<ul>
<li>
<code>colors_use_dimreduc</code> can be used to define colors for dimensionality reduction plot. Can either be vector or two colors to be used to create gradient or a define gradient.</li>
<li>
<code>order</code> whether or not to reorder the points so that higher loading points are plotted on top of lower loading cells (avoids cell hiding). Default is FALSE.</li>
</ul>
<div id="important-axes-labels-1" class="section level4">
<h4 class="hasAnchor">
<a href="#important-axes-labels-1" class="anchor"></a>/* IMPORTANT: AXES LABELS /*</h4>
<p>Unfortunately, the liger/rliger package does not properly store the name of the dimensionality reduction technique used and labels all plots with tSNE1/tSNE2 or dr1/dr2.</p>
<p><code>plotFactors_scCustom</code> solves this by providing extra parameter: <code>reduction_label</code> in the function that can be used to set labels. The first time you use <code>plotFactors_scCustom</code> in R session it will print a one-time message alerting you to the fact that this parameter exists and is set to “UMAP” by default (as it seems to be most commonly used method currently).</p>
</div>
</div>
</div>
<div id="extract-top-loading-genes-per-factor" class="section level2">
<h2 class="hasAnchor">
<a href="#extract-top-loading-genes-per-factor" class="anchor"></a>Extract Top Loading Genes per Factor</h2>
<p>Following plotting with <code>plotFactors_scCustom</code> it can sometimes be helpful to pull list of top loading genes for particular factor. <code>Top_Genes_Factor</code> provides quick function to extract the list of genes that loads highly on particular iNMF factor.<br><em>NOTE: This function simply extracts top loading genes in order from given factor. It does not assess whether that number of genes is significant, etc.</em></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">top20_factor6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Top_Genes_Factor.html">Top_Genes_Factor</a></span><span class="op">(</span>liger_object <span class="op">=</span> <span class="va">marsh_liger</span>, liger_factor <span class="op">=</span> <span class="fl">6</span>, num_genes <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">top20_factor6</span>, <span class="fl">5</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "Ifit3"  "Ifit2"  "Ifit3b" "Ifit1"  "Irf7"</code></pre>
</div>
<div id="convert-liger-to-seurat" class="section level2">
<h2 class="hasAnchor">
<a href="#convert-liger-to-seurat" class="anchor"></a>Convert LIGER to Seurat</h2>
<p>The liger/rliger package already contains a function <code>seuratToLiger</code> to convert LIGER objects to Seurat Objects. However, during this transfer a few things have issues crop up:</p>
<ul>
<li>All meta data ecept the “dataset” column from liger_object@cell.data is lost.</li>
<li>Seurat dimensionality reduction is set to tSNE regardless of method used in LIGER analysis</li>
<li>Seurat assay name not specified</li>
</ul>
<p>scCustomize contains modified version of this function named <code>Liger_to_Seurat</code> that solves these issues with 3 extra parameters:</p>
<ul>
<li>
<code>keep_meta</code> logical. Whether to keep meta data from the @cell.data slot in LIGER object. Default is TRUE.</li>
<li>
<code>reduction_label</code> Name of dimensionality reduction technique used (e.g., tSNE, UMAP, etc). Ensures dim names are set correctly in Seurat object.</li>
<li>
<code>seurat_assay</code> Name of assay to use for data in Seurat object. Default is “RNA”.</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">seurat_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Liger_to_Seurat.html">Liger_to_Seurat</a></span><span class="op">(</span>liger_object <span class="op">=</span> <span class="va">liger_object</span>, reduction_label <span class="op">=</span> <span class="st">"UMAP"</span><span class="op">)</span></code></pre></div>
</div>
<div id="gene-utilities" class="section level2">
<h2 class="hasAnchor">
<a href="#gene-utilities" class="anchor"></a>Gene Utilities</h2>
<p>As discussed in helpers vignette <a href="LINK">LINK</a>, the <code>Gene_Present</code> function can be used to check if list of genes are present in a LIGER object.</p>
<p>By default this will query all datasets in the object to create unified gene list and check input gene list against that list.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gene_input_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"P2ry12"</span>, <span class="st">"Fcrls"</span>, <span class="st">"Aif1"</span><span class="op">)</span>

<span class="va">genes_present</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Gene_Present.html">Gene_Present</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">marsh_liger</span>, gene_list <span class="op">=</span> <span class="va">gene_input_list</span><span class="op">)</span></code></pre></div>
<p>However you can check individual datasets within object by supplying those matrices to the <code>data</code> parameter.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gene_input_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"P2ry12"</span>, <span class="st">"Fcrls"</span>, <span class="st">"Aif1"</span><span class="op">)</span>

<span class="va">genes_present</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Gene_Present.html">Gene_Present</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">marsh_liger</span><span class="op">@</span><span class="va">raw.data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, gene_list <span class="op">=</span> <span class="va">gene_input_list</span><span class="op">)</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Samuel Marsh.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
