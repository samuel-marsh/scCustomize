<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LIGER Plotting &amp; Functionality • scCustomize</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="LIGER Plotting &amp; Functionality">
<meta property="og:description" content="scCustomize">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scCustomize</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Getting Started</a>
</li>
<li>
  <a href="../articles/Installation.html">Install</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Plotting Vignettes</li>
    <li>
      <a href="../articles/Gene_Expression_Plotting.html">Plotting #1: General Analysis Plots</a>
    </li>
    <li>
      <a href="../articles/QC_Plots.html">Plotting #2: QC Plots</a>
    </li>
    <li>
      <a href="../articles/Sequencing_QC_Plots.html">Plotting #3: Sequencing QC Plots/Analysis</a>
    </li>
    <li>
      <a href="../articles/Iterative_Plotting.html">Plotting #4: Iterative Plotting Functions</a>
    </li>
    <li>
      <a href="../articles/Color_Palettes.html">Customized Color Palettes &amp; Themes</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Helpers &amp; Utilities</li>
    <li>
      <a href="../articles/Helpers_and_Utilities.html">General Helpers &amp; Utilities</a>
    </li>
    <li>
      <a href="../articles/Read_and_Write_Functions.html">Read &amp; Write Data Functions</a>
    </li>
    <li>
      <a href="../articles/Markers_and_Cluster_Annotation.html">Marker Identification &amp; Cluster Annotation Helpers</a>
    </li>
    <li>
      <a href="../articles/Statistics.html">Statistics Functions</a>
    </li>
    <li>
      <a href="../articles/Misc_Functions.html">Misc Functions</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Other Package Interactivity/Functions</li>
    <li>
      <a href="../articles/LIGER_Functions.html">LIGER Plotting &amp; Functionality</a>
    </li>
    <li>
      <a href="../articles/Cell_Bender_Functions.html">Cell Bender Functionality &amp; Plotting</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News/Changelog</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/FAQ.html">FAQ</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/samuel-marsh/scCustomize/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>LIGER Plotting &amp; Functionality</h1>
            
            <h4 data-toc-skip class="date">Compiled: November 20,
2023</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/samuel-marsh/scCustomize/blob/HEAD/vignettes/articles/LIGER_Functions.Rmd" class="external-link"><code>vignettes/articles/LIGER_Functions.Rmd</code></a></small>
      <div class="hidden name"><code>LIGER_Functions.Rmd</code></div>

    </div>

    
    
<hr>
<style>
p.caption {
  font-size: 0.9em;
}
</style>
<div class="section level2">
<h2 id="interactivity-with-liger-objects">Interactivity with LIGER Objects<a class="anchor" aria-label="anchor" href="#interactivity-with-liger-objects"></a>
</h2>
<p>While the majority of scCustomize’s current functionality is with
Seurat Objects there are a few functions for working with LIGER objects
too.</p>
<p>For this tutorial, I will be utilizing microglia data from Marsh et
al., 2022 (<a href="https://doi.org/10.1038/s41593-022-01022-8" class="external-link"><em>Nature
Neuroscience</em></a>) which I have converted to LIGER object.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load Packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://satijalab.org/seurat" class="external-link">Seurat</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/welch-lab/liger" class="external-link">rliger</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/samuel-marsh/scCustomize" class="external-link">scCustomize</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/traversc/qs" class="external-link">qs</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># read object</span></span>
<span><span class="va">marsh_micro</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/qs/man/qread.html" class="external-link">qread</a></span><span class="op">(</span><span class="st">"assets/marsh_2020_micro.qs"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert to liger</span></span>
<span><span class="va">marsh_liger</span> <span class="op">&lt;-</span> <span class="fu">rliger</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rliger/man/seuratToLiger.html" class="external-link">seuratToLiger</a></span><span class="op">(</span>objects <span class="op">=</span> <span class="va">marsh_micro</span>, combined.seurat <span class="op">=</span> <span class="cn">TRUE</span>, use.idents <span class="op">=</span> <span class="cn">T</span>,</span>
<span>    use.tsne <span class="op">=</span> <span class="cn">T</span>, meta.var <span class="op">=</span> <span class="st">"orig.ident"</span>, remove.missing <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add meta data to LIGER \@cell.data slot</span></span>
<span><span class="va">marsh_liger</span><span class="op">@</span><span class="va">cell.data</span><span class="op">$</span><span class="va">Transcription</span> <span class="op">&lt;-</span> <span class="va">marsh_micro</span><span class="op">@</span><span class="va">meta.data</span><span class="op">$</span><span class="va">Transcription</span></span>
<span><span class="va">marsh_liger</span><span class="op">@</span><span class="va">cell.data</span><span class="op">$</span><span class="va">Method</span> <span class="op">&lt;-</span> <span class="va">marsh_micro</span><span class="op">@</span><span class="va">meta.data</span><span class="op">$</span><span class="va">Method</span></span>
<span><span class="va">marsh_liger</span><span class="op">@</span><span class="va">cell.data</span><span class="op">$</span><span class="va">Batch</span> <span class="op">&lt;-</span> <span class="va">marsh_micro</span><span class="op">@</span><span class="va">meta.data</span><span class="op">$</span><span class="va">Batch</span></span>
<span><span class="va">marsh_liger</span><span class="op">@</span><span class="va">cell.data</span><span class="op">$</span><span class="va">Transcription_Method</span> <span class="op">&lt;-</span> <span class="va">marsh_micro</span><span class="op">@</span><span class="va">meta.data</span><span class="op">$</span><span class="va">Transcription_Method</span></span></code></pre></div>
<div class="section level3">
<h3 id="dimensionality-reduction-plotting">Dimensionality Reduction Plotting<a class="anchor" aria-label="anchor" href="#dimensionality-reduction-plotting"></a>
</h3>
<p>scCustomize contains new LIGER plotting function
<code><a href="../reference/DimPlot_LIGER.html">DimPlot_LIGER()</a></code> that both adds functionality not present in
LIGER package and provides function for plotting that is easier to use
for those more familiar with Seurat’s <code><a href="https://satijalab.org/seurat/reference/DimPlot.html" class="external-link">DimPlot()</a></code></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/DimPlot_LIGER.html">DimPlot_LIGER</a></span><span class="op">(</span>liger_object <span class="op">=</span> <span class="va">marsh_liger</span><span class="op">)</span></span></code></pre></div>
<p><img src="LIGER_Functions_files/figure-html/unnamed-chunk-3-1.png" width="576" style="display: block; margin: auto;"></p>
<p>As you can see we get plot that looks very similar to thought
generated by <code><a href="../reference/DimPlot_scCustom.html">DimPlot_scCustom()</a></code> or
<code><a href="https://satijalab.org/seurat/reference/DimPlot.html" class="external-link">Seurat::DimPlot()</a></code>.</p>
<div class="section level5">
<h5 id="important-axes-labels">/* IMPORTANT: AXES LABELS /*<a class="anchor" aria-label="anchor" href="#important-axes-labels"></a>
</h5>
<p>Unfortunately, the liger/rliger package does not properly store the
name of the dimensionality reduction technique used and labels all plots
with tSNE1/tSNE2 or dr1/dr2.</p>
<p><code><a href="../reference/DimPlot_LIGER.html">DimPlot_LIGER()</a></code> solves this by providing extra parameter
in the function that can be used to set labels. The first time you use
<code>DimPlot_LIGER</code> in R session it will print a one-time message
alerting you to the fact that this parameter exists and is set to “UMAP”
by default (as it seems to be most commonly used method currently).</p>
<p>However, this analysis object used tSNE so let’s change that
parameter.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/DimPlot_LIGER.html">DimPlot_LIGER</a></span><span class="op">(</span>liger_object <span class="op">=</span> <span class="va">marsh_liger</span>, reduction_label <span class="op">=</span> <span class="st">"tSNE"</span><span class="op">)</span></span></code></pre></div>
<p><img src="LIGER_Functions_files/figure-html/unnamed-chunk-4-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="optional-functionalityparameters">Optional functionality/Parameters<a class="anchor" aria-label="anchor" href="#optional-functionalityparameters"></a>
</h4>
<p><code>DimPlot_LIGER</code> adds a number of options not present in
liger plotting and modifies naming/functionality of others to be more
in-line with Seurat for ease of use.</p>
</div>
<div class="section level4">
<h4 id="plot-combination">Plot combination<a class="anchor" aria-label="anchor" href="#plot-combination"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/DimPlot_LIGER.html">DimPlot_LIGER</a></span><span class="op">(</span>liger_object <span class="op">=</span> <span class="va">marsh_liger</span>, reduction_label <span class="op">=</span> <span class="st">"tSNE"</span>, combination <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="LIGER_Functions_files/figure-html/unnamed-chunk-5-1.png" width="1248" style="display: block; margin: auto;"></p>
<p>User can specify different color palettes for each plot</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clu_color</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ColorBlind_Pal.html">ColorBlind_Pal</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">sample_color</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DiscretePalette_scCustomize.html">DiscretePalette_scCustomize</a></span><span class="op">(</span>num_colors <span class="op">=</span> <span class="fl">12</span>, palette <span class="op">=</span> <span class="st">"alphabet"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/DimPlot_LIGER.html">DimPlot_LIGER</a></span><span class="op">(</span>liger_object <span class="op">=</span> <span class="va">marsh_liger</span>, reduction_label <span class="op">=</span> <span class="st">"tSNE"</span>, combination <span class="op">=</span> <span class="cn">T</span>, colors_use_cluster <span class="op">=</span> <span class="va">clu_color</span>,</span>
<span>    colors_use_meta <span class="op">=</span> <span class="va">sample_color</span><span class="op">)</span></span></code></pre></div>
<p><img src="LIGER_Functions_files/figure-html/unnamed-chunk-6-1.png" width="1248" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="grouping-and-splitting-plots">Grouping and Splitting Plots<a class="anchor" aria-label="anchor" href="#grouping-and-splitting-plots"></a>
</h4>
<p><code>DimPlot_LIGER</code> supports grouping and splitting plots by
meta data variables or cluster and will return patchwork layout</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/DimPlot_LIGER.html">DimPlot_LIGER</a></span><span class="op">(</span>liger_object <span class="op">=</span> <span class="va">marsh_liger</span>, reduction_label <span class="op">=</span> <span class="st">"tSNE"</span>, group_by <span class="op">=</span> <span class="st">"Transcription_Method"</span>,</span>
<span>    colors_use_meta <span class="op">=</span> <span class="fu"><a href="../reference/JCO_Four.html">JCO_Four</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="LIGER_Functions_files/figure-html/unnamed-chunk-7-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/DimPlot_LIGER.html">DimPlot_LIGER</a></span><span class="op">(</span>liger_object <span class="op">=</span> <span class="va">marsh_liger</span>, reduction_label <span class="op">=</span> <span class="st">"tSNE"</span>, group_by <span class="op">=</span> <span class="st">"Cluster"</span>, split_by <span class="op">=</span> <span class="st">"Transcription_Method"</span>,</span>
<span>    label <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="LIGER_Functions_files/figure-html/unnamed-chunk-8-1.png" width="1152" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="cluster-label-modification">Cluster Label Modification<a class="anchor" aria-label="anchor" href="#cluster-label-modification"></a>
</h4>
<p><code>DimPlot_LIGER</code> supports many different modifications of
cluster labels. <em>NOTE: labeling is only supported when plotting by
cluster.</em></p>
<ul>
<li>
<code>label</code> logical. Whether to label clusters on plot.</li>
<li>
<code>label_size</code> Change label text size.</li>
<li>
<code>label_repel</code> logical. Whether to repel labels.</li>
<li>
<code>label_box</code> logical. Whether to place box around
label.</li>
<li>
<code>label_color</code> change label text color.</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/DimPlot_LIGER.html">DimPlot_LIGER</a></span><span class="op">(</span>liger_object <span class="op">=</span> <span class="va">marsh_liger</span>, reduction_label <span class="op">=</span> <span class="st">"tSNE"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/DimPlot_LIGER.html">DimPlot_LIGER</a></span><span class="op">(</span>liger_object <span class="op">=</span> <span class="va">marsh_liger</span>, reduction_label <span class="op">=</span> <span class="st">"tSNE"</span>, label <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/DimPlot_LIGER.html">DimPlot_LIGER</a></span><span class="op">(</span>liger_object <span class="op">=</span> <span class="va">marsh_liger</span>, reduction_label <span class="op">=</span> <span class="st">"tSNE"</span>, label_repel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/DimPlot_LIGER.html">DimPlot_LIGER</a></span><span class="op">(</span>liger_object <span class="op">=</span> <span class="va">marsh_liger</span>, reduction_label <span class="op">=</span> <span class="st">"tSNE"</span>, label_repel <span class="op">=</span> <span class="cn">TRUE</span>, label_box <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    label_size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="LIGER_Functions_files/figure-html/unnamed-chunk-10-1.png" width="1152" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="raster-points">Raster Points<a class="anchor" aria-label="anchor" href="#raster-points"></a>
</h4>
<p><code><a href="../reference/DimPlot_LIGER.html">DimPlot_LIGER()</a></code> also supports point rasterization
utilizing <a href="https://cran.rstudio.com/web/packages/scattermore/index.html" class="external-link">scattermore
package</a>. Axes, labels, and legends will remain in vector
form.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/DimPlot_LIGER.html">DimPlot_LIGER</a></span><span class="op">(</span>liger_object <span class="op">=</span> <span class="va">marsh_liger</span>, reduction_label <span class="op">=</span> <span class="st">"tSNE"</span>, raster <span class="op">=</span> <span class="cn">FALSE</span>, label <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/DimPlot_LIGER.html">DimPlot_LIGER</a></span><span class="op">(</span>liger_object <span class="op">=</span> <span class="va">marsh_liger</span>, reduction_label <span class="op">=</span> <span class="st">"tSNE"</span>, raster <span class="op">=</span> <span class="cn">TRUE</span>, label <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="LIGER_Functions_files/figure-html/unnamed-chunk-12-1.png" width="1152" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="restore-ggplot2-default-color-scheme">Restore ggplot2 default color scheme<a class="anchor" aria-label="anchor" href="#restore-ggplot2-default-color-scheme"></a>
</h4>
<p>If you would like to restore ggplot2 default color scheme but
maintain the rest of the aesthetics of <code>DimPlot_LIGER</code> simply
set parameter <code>ggplot_default_colors = TRUE</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/DimPlot_LIGER.html">DimPlot_LIGER</a></span><span class="op">(</span>liger_object <span class="op">=</span> <span class="va">marsh_liger</span>, reduction_label <span class="op">=</span> <span class="st">"tSNE"</span>, ggplot_default_colors <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="LIGER_Functions_files/figure-html/unnamed-chunk-13-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level3">
<h3 id="customized-plotfactors-functionality">Customized plotFactors Functionality<a class="anchor" aria-label="anchor" href="#customized-plotfactors-functionality"></a>
</h3>
<p><em>NOTE: For this example as “marsh_liger” was not originally a
LIGER analyzed object it has no factors. So I ran a basic LIGER pipeline
(with no specific parameters to demonstrate functionality of
<code>Top_Genes_Factor</code>)</em></p>
<p>scCustomize contains function <code><a href="../reference/plotFactors_scCustom.html">plotFactors_scCustom()</a></code>
which expands the functionality and customizes the visualizes of LIGER’s
<code><a href="https://rdrr.io/pkg/rliger/man/plotFactors.html" class="external-link">plotFactors()</a></code> function.</p>
<div class="section level4">
<h4 id="plots-created">Plots Created<a class="anchor" aria-label="anchor" href="#plots-created"></a>
</h4>
<p><code>plotFactors_scCustom</code> returns two different plots for
each iNMF factor. First, is plot of the factor loadings for each cell,
grouped by dataset. The second is visualization of the factor loading on
the dimensionality reduction coordinates.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">returned_plots</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">returned_plots</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">wrap_plots</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="LIGER_Functions_files/figure-html/unnamed-chunk-16-1.png" width="1152" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="additional-plot-savereturn-functionality">Additional Plot Save/Return Functionality<a class="anchor" aria-label="anchor" href="#additional-plot-savereturn-functionality"></a>
</h4>
<p><code>plotFactors_scCustom</code> has a number of additional
parameters that expand the functionality of
<code>plotFactors</code>.</p>
<ul>
<li>
<code>save_plots</code> and/or <code>return_plots</code> logical
parameters to either return plots to assigned variable in environment or
save the plots to PDF (or both).</li>
<li>
<code>file_path</code> and <code>file_name</code> optional
parameters required if saving plots to PDF.</li>
<li>
<code>raster</code> whether or not to raster the points in both
plots. Significantly reduced PDF file size and speed of plotting.</li>
</ul>
</div>
<div class="section level4">
<h4 id="additional-factor-plot-functionality">Additional Factor Plot Functionality<a class="anchor" aria-label="anchor" href="#additional-factor-plot-functionality"></a>
</h4>
<p><code>plotFactors_scCustom</code> has a number of additional
parameters that significantly expand the visualization options of
<code>plotFactors</code>.</p>
<ul>
<li>
<code>colors_use_factors</code> can be used to color the datasets in
the factor loading plot. Must be vector equal to or greater than number
of datasets in object. By default uses the “varibow” palette from
<code>DiscretePalette_scCustom</code> instead of default ggplot2 hue
palette.<br>
</li>
<li>
<code>ggplot_default_colors</code> parameter can be specified if you
would like to return this plot to using the ggplot2/hue palette.</li>
</ul>
<p><img src="LIGER_Functions_files/figure-html/unnamed-chunk-18-1.png" width="1152" style="display: block; margin: auto;"></p>
<ul>
<li>
<code>reorder_datasets</code> new order to plot datasets in. By
default plots in factor level order from the <span class="citation">@cell.data</span> slot but this can be reordered just
for plotting without changing the underlying object.</li>
</ul>
<p><img src="LIGER_Functions_files/figure-html/unnamed-chunk-20-1.png" width="1152" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="added-dimensionality-reduction-functionality">Added Dimensionality Reduction Functionality<a class="anchor" aria-label="anchor" href="#added-dimensionality-reduction-functionality"></a>
</h4>
<ul>
<li>
<code>colors_use_dimreduc</code> can be used to define colors for
dimensionality reduction plot. Can either be vector or two colors to be
used to create gradient or a define gradient.</li>
<li>
<code>order</code> whether or not to reorder the points so that
higher loading points are plotted on top of lower loading cells (avoids
cell hiding). Default is FALSE.</li>
</ul>
<div class="section level5">
<h5 id="important-axes-labels-1">/* IMPORTANT: AXES LABELS /*<a class="anchor" aria-label="anchor" href="#important-axes-labels-1"></a>
</h5>
<p>Unfortunately, the liger/rliger package does not properly store the
name of the dimensionality reduction technique used and labels all plots
with tSNE1/tSNE2 or dr1/dr2.</p>
<p><code>plotFactors_scCustom</code> solves this by providing extra
parameter: <code>reduction_label</code> in the function that can be used
to set labels. The first time you use <code>plotFactors_scCustom</code>
in R session it will print a one-time message alerting you to the fact
that this parameter exists and is set to “UMAP” by default (as it seems
to be most commonly used method currently).</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="extract-top-loading-genes-per-factor">Extract Top Loading Genes per Factor<a class="anchor" aria-label="anchor" href="#extract-top-loading-genes-per-factor"></a>
</h3>
<p>Following plotting with <code>plotFactors_scCustom</code> it can
sometimes be helpful to pull list of top loading genes for particular
factor. <code>Top_Genes_Factor</code> provides quick function to extract
the list of genes that loads highly on particular iNMF factor.<br><em>NOTE: This function simply extracts top loading genes in order from
given factor. It does not assess whether that number of genes is
significant, etc.</em></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top20_factor6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Top_Genes_Factor.html">Top_Genes_Factor</a></span><span class="op">(</span>liger_object <span class="op">=</span> <span class="va">marsh_liger</span>, liger_factor <span class="op">=</span> <span class="fl">6</span>, num_genes <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">top20_factor6</span>, <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Ifit3"  "Ifit2"  "Ifit3b" "Ifit1"  "Irf7"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="convert-liger-to-seurat">Convert LIGER to Seurat<a class="anchor" aria-label="anchor" href="#convert-liger-to-seurat"></a>
</h3>
<p>The liger/rliger package already contains a function
<code><a href="https://rdrr.io/pkg/rliger/man/seuratToLiger.html" class="external-link">seuratToLiger()</a></code> to convert LIGER objects to Seurat Objects.
However, during this transfer a few things have issues crop up:</p>
<ul>
<li>All meta data except the “dataset” column from
liger_object@cell.data is lost.</li>
<li>Seurat dimensionality reduction is set to tSNE regardless of method
used in LIGER analysis</li>
<li>Seurat assay name not specified</li>
</ul>
<p>scCustomize contains modified version of this function named
<code><a href="../reference/Liger_to_Seurat.html">Liger_to_Seurat()</a></code> that solves these issues with 3 extra
parameters:</p>
<ul>
<li>
<code>keep_meta</code> logical. Whether to keep meta data from the
@cell.data slot in LIGER object. Default is TRUE.</li>
<li>
<code>reduction_label</code> Name of dimensionality reduction
technique used (e.g., tSNE, UMAP, etc). Ensures dim names are set
correctly in Seurat object.</li>
<li>
<code>seurat_assay</code> Name of assay to use for data in Seurat
object. Default is “RNA”.</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seurat_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Liger_to_Seurat.html">Liger_to_Seurat</a></span><span class="op">(</span>liger_object <span class="op">=</span> <span class="va">liger_object</span>, reduction_label <span class="op">=</span> <span class="st">"UMAP"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="add-mitochondrial-ribosomal-percentages">Add Mitochondrial &amp; Ribosomal Percentages<a class="anchor" aria-label="anchor" href="#add-mitochondrial-ribosomal-percentages"></a>
</h3>
<p>For more information on adding mitochondrial and ribosomal count
percentages to LIGER objects see <a href="https://samuel-marsh.github.io/scCustomize/articles/Helpers_and_Utilities.html">General
Utilities and Helpers Vignette</a> for information on
<code>Add_Mito_Ribo_LIGER</code> which is analogous to
<code>Add_Mito_Ribo_Seurat</code>.</p>
</div>
<div class="section level3">
<h3 id="variable-gene-selection">Variable Gene Selection<a class="anchor" aria-label="anchor" href="#variable-gene-selection"></a>
</h3>
<p>By default when selecting highly variable genes in LIGER using
<code><a href="https://rdrr.io/pkg/rliger/man/selectGenes.html" class="external-link">rliger::selectGenes()</a></code> LIGER performs gene selection across
all datasets in the object and then can either take the union or
intersection of those lists (default is union). However, sometimes for
analysis you may want to select highly variable genes from all data
combined.</p>
<p>scCustomize provides the function
<code><a href="../reference/Variable_Features_ALL_LIGER.html">Variable_Features_ALL_LIGER()</a></code> that will do just that and
returns the variable genes list to the <code>@var.genes</code> slot of
original LIGER object.<br><em>NOTE: This function creates a temporary LIGER object by merging all
of the matrices present in original object and then running variable
gene selection. Therefore, while running the function it will use
significant memory resources (equivalent to size of original
object).</em></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Select highly variable genes based on threshold</span></span>
<span><span class="va">marsh_liger</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Variable_Features_ALL_LIGER.html">Variable_Features_ALL_LIGER</a></span><span class="op">(</span>liger_object <span class="op">=</span> <span class="va">marsh_liger</span>, var.thresh <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Select based on specific number of variable genes</span></span>
<span><span class="va">marsh_liger</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Variable_Features_ALL_LIGER.html">Variable_Features_ALL_LIGER</a></span><span class="op">(</span>liger_object <span class="op">=</span> <span class="va">marsh_liger</span>, num_genes <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="gene-utilities">Gene Utilities<a class="anchor" aria-label="anchor" href="#gene-utilities"></a>
</h3>
<p>As discussed in <a href="https://samuel-marsh.github.io/scCustomize/articles/Helpers_and_Utilities.html">helpers
vignette</a>, the <code><a href="../reference/Gene_Present.html">Gene_Present()</a></code> function can be used to
check if list of genes are present in a LIGER object.</p>
<p>By default this will query all datasets in the object to create
unified gene list and check input gene list against that list.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gene_input_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P2ry12"</span>, <span class="st">"Fcrls"</span>, <span class="st">"Aif1"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">genes_present</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Gene_Present.html">Gene_Present</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">marsh_liger</span>, gene_list <span class="op">=</span> <span class="va">gene_input_list</span><span class="op">)</span></span></code></pre></div>
<p>However you can check individual datasets within object by supplying
those matrices to the <code>data</code> parameter.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gene_input_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P2ry12"</span>, <span class="st">"Fcrls"</span>, <span class="st">"Aif1"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">genes_present</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Gene_Present.html">Gene_Present</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">marsh_liger</span><span class="op">@</span><span class="va">raw.data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, gene_list <span class="op">=</span> <span class="va">gene_input_list</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Samuel Marsh.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
