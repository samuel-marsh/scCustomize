<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>cNMF_Functionality &amp; Plotting • scCustomize</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="cNMF_Functionality &amp; Plotting">
<meta property="og:description" content="scCustomize">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scCustomize</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.2.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Getting Started</a>
</li>
<li>
  <a href="../articles/Installation.html">Install</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Plotting Vignettes</li>
    <li>
      <a href="../articles/Gene_Expression_Plotting.html">Plotting #1: General Analysis Plots</a>
    </li>
    <li>
      <a href="../articles/QC_Plots.html">Plotting #2: QC Plots &amp; Analysis</a>
    </li>
    <li>
      <a href="../articles/Sequencing_QC_Plots.html">Plotting #3: Sequencing QC Plots/Analysis</a>
    </li>
    <li>
      <a href="../articles/Iterative_Plotting.html">Plotting #4: Iterative Plotting Functions</a>
    </li>
    <li>
      <a href="../articles/Spatial_Plotting.html">Plotting #5: Spatial Plotting Functions</a>
    </li>
    <li>
      <a href="../articles/Color_Palettes.html">Customized Color Palettes &amp; Themes</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Helpers &amp; Utilities</li>
    <li>
      <a href="../articles/Helpers_and_Utilities.html">General Helpers &amp; Utilities</a>
    </li>
    <li>
      <a href="../articles/Object_QC_Functions.html">Object QC Functions</a>
    </li>
    <li>
      <a href="../articles/Read_and_Write_Functions.html">Read &amp; Write Data Functions</a>
    </li>
    <li>
      <a href="../articles/Object_Conversion.html">Object/Assay Format Conversion</a>
    </li>
    <li>
      <a href="../articles/Markers_and_Cluster_Annotation.html">Marker Identification &amp; Cluster Annotation Helpers</a>
    </li>
    <li>
      <a href="../articles/Statistics.html">Statistics Functions</a>
    </li>
    <li>
      <a href="../articles/Update_Gene_Symbols.html">Updating Gene Symbols</a>
    </li>
    <li>
      <a href="../articles/Misc_Functions.html">Misc Functions</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Other Package Interactivity/Functions</li>
    <li>
      <a href="../articles/LIGER_Functions.html">LIGER Plotting &amp; Functionality</a>
    </li>
    <li>
      <a href="../articles/Cell_Bender_Functions.html">Cell Bender Functionality &amp; Plotting</a>
    </li>
    <li>
      <a href="../articles/cNMF_Functionality.html">cNMF Functionality &amp; Plotting</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News/Changelog</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/FAQ.html">FAQ</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/samuel-marsh/scCustomize/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="cNMF_Functionality_files/kePrint-0.0.1/kePrint.js"></script><link href="cNMF_Functionality_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>cNMF_Functionality &amp; Plotting</h1>
            
            <h4 data-toc-skip class="date">Compiled: December 11,
2025</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/samuel-marsh/scCustomize/blob/HEAD/vignettes/articles/cNMF_Functionality.Rmd" class="external-link"><code>vignettes/articles/cNMF_Functionality.Rmd</code></a></small>
      <div class="hidden name"><code>cNMF_Functionality.Rmd</code></div>

    </div>

    
    
<hr>
<style>
p.caption {
  font-size: 0.9em;
}
</style>
<div class="section level2">
<h2 id="interaction-with-consensus-non-negative-matrix-factorization-cnmf">Interaction with consensus non-negative matrix factorization
(cNMF)<a class="anchor" aria-label="anchor" href="#interaction-with-consensus-non-negative-matrix-factorization-cnmf"></a>
</h2>
<p>scCustomize contains functions to aid in the interaction with results
of consensus non-negative matrix factorization (cNMF) and Seurat
objects. For more information on cNMF see <a href="https://github.com/dylkot/cNMF" class="external-link">cNMF GitHub Repo</a> and <a href="https://elifesciences.org/articles/43803" class="external-link">cNMF
Publication</a>.</p>
<p>For this example we will use example outputs from using the pbmc3k
object run using the same paramters as shown in <a href="https://htmlpreview.github.io/?https://github.com/dylkot/cNMF/blob/main/Tutorials/R_vignette.nb.html" class="external-link">cNMF
R vignette</a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://satijalab.org/seurat" class="external-link">Seurat</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/samuel-marsh/scCustomize" class="external-link">scCustomize</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load pbmc dataset</span></span>
<span><span class="va">pbmc</span> <span class="op">&lt;-</span> <span class="fu">pbmc3k.SeuratData</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/pbmc3k.SeuratData/man/pbmc3k.html" class="external-link">pbmc3k</a></span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run basic analysis (copied from pbmc3k vignette)</span></span>
<span><span class="va">pbmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/NormalizeData.html" class="external-link">NormalizeData</a></span><span class="op">(</span><span class="va">pbmc</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://satijalab.org/seurat/reference/FindVariableFeatures.html" class="external-link">FindVariableFeatures</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://satijalab.org/seurat/reference/ScaleData.html" class="external-link">ScaleData</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://satijalab.org/seurat/reference/RunPCA.html" class="external-link">RunPCA</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://satijalab.org/seurat/reference/FindNeighbors.html" class="external-link">FindNeighbors</a></span><span class="op">(</span>dims <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://satijalab.org/seurat/reference/FindClusters.html" class="external-link">FindClusters</a></span><span class="op">(</span>resolution <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://satijalab.org/seurat/reference/RunUMAP.html" class="external-link">RunUMAP</a></span><span class="op">(</span>dims <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of nodes: 2700</span></span>
<span><span class="co">## Number of edges: 97892</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Running Louvain algorithm...</span></span>
<span><span class="co">## Maximum modularity in 10 random starts: 0.8719</span></span>
<span><span class="co">## Number of communities: 9</span></span>
<span><span class="co">## Elapsed time: 0 seconds</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new.cluster.ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Naive CD4 T"</span>, <span class="st">"CD14+ Mono"</span>, <span class="st">"Memory CD4 T"</span>, <span class="st">"B"</span>, <span class="st">"CD8 T"</span>, <span class="st">"FCGR3A+ Mono"</span>,</span>
<span>    <span class="st">"NK"</span>, <span class="st">"DC"</span>, <span class="st">"Platelet"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">new.cluster.ids</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">pbmc</span><span class="op">)</span></span>
<span><span class="va">pbmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.github.io/seurat-object/reference/Idents.html" class="external-link">RenameIdents</a></span><span class="op">(</span><span class="va">pbmc</span>, <span class="va">new.cluster.ids</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/DimPlot_scCustom.html">DimPlot_scCustom</a></span><span class="op">(</span><span class="va">pbmc</span>, label <span class="op">=</span> <span class="cn">TRUE</span>, pt.size <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/SeuratTheme.html" class="external-link">NoLegend</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="cNMF_Functionality_files/figure-html/unnamed-chunk-3-1.png" width="1248" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="loading-the-results-of-cnmf">Loading the results of cNMF<a class="anchor" aria-label="anchor" href="#loading-the-results-of-cnmf"></a>
</h2>
<p>scCustomize contains the function <code>Read_Add_cNMF</code> that can
take the results from cNMF and add custom dimensionality reduction to
Seurat object. The function only requires user to supply the paths to
the cNMF usage and spectra files that contain the cell and feature
loadings respectively. By default this will add new reduction “cnmf” to
the Seurat object.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pbmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Read_Add_cNMF.html">Read_Add_cNMF</a></span><span class="op">(</span>seurat_object <span class="op">=</span> <span class="va">pbmc</span>, usage_file <span class="op">=</span> <span class="st">"assets/cNMF_Example_Data/example_cNMF.usages.k_7.dt_0_1.consensus.txt"</span>,</span>
<span>    spectra_file <span class="op">=</span> <span class="st">"assets/cNMF_Example_Data/example_cNMF.gene_spectra_score.k_7.dt_0_1.txt"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="optional-parameters">Optional parameters<a class="anchor" aria-label="anchor" href="#optional-parameters"></a>
</h3>
<p>There are few optional parameters in <code>Read_Add_cNMF</code> for
increased user control if desired.<br>
* <code>reduction_name</code> &amp; <code>reduction_key</code> These can
used to either change defaults (“cnmf” and “cNMF_” respectively) or if
user wants to add results from multiple cNMF runs different names can be
supplied for each one.<br>
- For instance save second reduction with different k value.<br>
* <code>overwrite</code> used to overwrite old cNMF reduction with new
data using the same <code>reduction_name</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add result from additional cNMF run as separate reduction (for instance with different k</span></span>
<span><span class="co"># value)</span></span>
<span><span class="va">pbmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Read_Add_cNMF.html">Read_Add_cNMF</a></span><span class="op">(</span>seurat_object <span class="op">=</span> <span class="va">pbmc</span>, usage_file <span class="op">=</span> <span class="st">"assets/cNMF_Example_Data/example_cNMF.usages.k_15.dt_0_1.consensus.txt"</span>,</span>
<span>    spectra_file <span class="op">=</span> <span class="st">"assets/cNMF_Example_Data/example_cNMF.gene_spectra_score.k_15.dt_0_1.txt"</span>, reduction_name <span class="op">=</span> <span class="st">"cnmf.alt"</span>,</span>
<span>    reduction_key <span class="op">=</span> <span class="st">"CNMFALT_"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Overwrite current cNMF reduction with new results but keep same `reduction_name`</span></span>
<span><span class="va">pbmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Read_Add_cNMF.html">Read_Add_cNMF</a></span><span class="op">(</span>seurat_object <span class="op">=</span> <span class="va">pbmc</span>, usage_file <span class="op">=</span> <span class="st">"assets/cNMF_Example_Data/example_cNMF.usages.k_15.dt_0_1.consensus.txt"</span>,</span>
<span>    spectra_file <span class="op">=</span> <span class="st">"assets/cNMF_Example_Data/example_cNMF.gene_spectra_score.k_15.dt_0_1.txt"</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="cnmf-plotting">cNMF Plotting<a class="anchor" aria-label="anchor" href="#cnmf-plotting"></a>
</h2>
<p>cNMF results can be plotted in several ways using scCustomize.</p>
<div class="section level3">
<h3 id="plotting-factor-loading">Plotting factor loading<a class="anchor" aria-label="anchor" href="#plotting-factor-loading"></a>
</h3>
<p>The cNMF factor cell loadings can be plotted like any other reduction
using <code>FeaturePlot_scCustom</code>. Just supply the name of the
factor like any other reduction.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/FeaturePlot_scCustom.html">FeaturePlot_scCustom</a></span><span class="op">(</span>seurat_object <span class="op">=</span> <span class="va">pbmc</span>, features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cNMF_1"</span>, <span class="st">"cNMF_2"</span>, <span class="st">"cNMF_3"</span>, <span class="st">"cNMF_4"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="cNMF_Functionality_files/figure-html/unnamed-chunk-6-1.png" width="1248" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="plot-factor-correlation">Plot factor correlation<a class="anchor" aria-label="anchor" href="#plot-factor-correlation"></a>
</h3>
<p>scCustomize also has plotting function <code>Factor_Cor_Plot</code>
to examine relationships between factors by plotting the correlation of
feature loadings for cNMF factors.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Factor_Cor_Plot.html">Factor_Cor_Plot</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">pbmc</span>, reduction <span class="op">=</span> <span class="st">"cnmf"</span><span class="op">)</span></span></code></pre></div>
<p><img src="cNMF_Functionality_files/figure-html/unnamed-chunk-7-1.png" width="1248" style="display: block; margin: auto;"></p>
<p>By default (above) <code>Factor_Cor_Plot</code> runs hierarchical
clustering on the correlations and orders the factors on the plot. But
users can also adjust this to plot the factors in numerical order.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Factor_Cor_Plot.html">Factor_Cor_Plot</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">pbmc</span>, reduction <span class="op">=</span> <span class="st">"cnmf"</span>, cluster <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="cNMF_Functionality_files/figure-html/unnamed-chunk-8-1.png" width="1248" style="display: block; margin: auto;"></p>
<p><code>Factor_Cor_Plot</code> also contains a number of other optional
parameters to change the output plot.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Only plot positive correlations</span></span>
<span><span class="fu"><a href="../reference/Factor_Cor_Plot.html">Factor_Cor_Plot</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">pbmc</span>, reduction <span class="op">=</span> <span class="st">"cnmf"</span>, positive_only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Only plot only the upper diagonal</span></span>
<span><span class="fu"><a href="../reference/Factor_Cor_Plot.html">Factor_Cor_Plot</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">pbmc</span>, reduction <span class="op">=</span> <span class="st">"cnmf"</span>, plot_type <span class="op">=</span> <span class="st">"upper"</span>, cluster <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Only plot only the lower diagonal</span></span>
<span><span class="fu"><a href="../reference/Factor_Cor_Plot.html">Factor_Cor_Plot</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">pbmc</span>, reduction <span class="op">=</span> <span class="st">"cnmf"</span>, plot_type <span class="op">=</span> <span class="st">"lower"</span>, cluster <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add clustering rectangles (uses `cutree`)</span></span>
<span><span class="fu"><a href="../reference/Factor_Cor_Plot.html">Factor_Cor_Plot</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">pbmc</span>, reduction <span class="op">=</span> <span class="st">"cnmf"</span>, cluster_rect <span class="op">=</span> <span class="cn">T</span>, cluster_rect_num <span class="op">=</span> <span class="fl">6</span>, cluster_rect_col <span class="op">=</span> <span class="st">"magenta"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="cNMF_Functionality_files/figure-html/unnamed-chunk-10-1.png" alt="***A.** Plotting only the positive correlations (negative correlations set to 0).  **B.** Plot only the upper diagonal (must set `cluster = FALSE`).  **C.** Plot only the lower diagonal (must set `cluster = FALSE`).  **D.** Add rectangles around clustered results (uses `cutree`).*" width="1248"><p class="caption">
<em><strong>A.</strong> Plotting only the positive correlations
(negative correlations set to 0). <strong>B.</strong> Plot only the
upper diagonal (must set <code>cluster = FALSE</code>).
<strong>C.</strong> Plot only the lower diagonal (must set
<code>cluster = FALSE</code>). <strong>D.</strong> Add rectangles around
clustered results (uses <code>cutree</code>).</em>
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="cnmf-interaction">cNMF Interaction<a class="anchor" aria-label="anchor" href="#cnmf-interaction"></a>
</h2>
<p>scCustomize also contains functions to interact with and retrive data
from the cNMF reduction.<br><em>NOTE: These functions are S3 generics and can be used to retrieve
the same information about LIGER iNMF reductions with given LIGER
object, or from iNMF reduction in Seurat object.</em></p>
<p>The function <code>Top_Genes_Factor</code> can be used to retrieve
top loading genes from cNMF factors. Let’s check what genes load most
heavily on factor 2 which we can see above loads heavily on CD14+
Monocyte cluster.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top_gene_factor1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Top_Genes_Factor.html">Top_Genes_Factor</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">pbmc</span>, factor <span class="op">=</span> <span class="fl">2</span>, reduction <span class="op">=</span> <span class="st">"cnmf"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">top_gene_factor1</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "LGALS1" "GSTP1"  "LGALS2" "TYROBP" "FCN1"   "CST3"   "CD14"   "S100A8"</span></span>
<span><span class="co">##  [9] "S100A9" "LYZ"</span></span></code></pre>
<p>By default <code>Top_Genes_Factor</code> will return the top 10
loading genes but can return any number of genes by supplying value to
the <code>num_genes</code> parameter.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top_gene_factor1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Top_Genes_Factor.html">Top_Genes_Factor</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">pbmc</span>, factor <span class="op">=</span> <span class="fl">2</span>, num_genes <span class="op">=</span> <span class="fl">20</span>, reduction <span class="op">=</span> <span class="st">"cnmf"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">top_gene_factor1</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "CSF3R"   "GABARAP" "TYMP"    "BLVRB"   "FTL"     "GRN"     "TSPO"   </span></span>
<span><span class="co">##  [8] "CEBPD"   "S100A6"  "AP1S2"   "LGALS1"  "GSTP1"   "LGALS2"  "TYROBP" </span></span>
<span><span class="co">## [15] "FCN1"    "CST3"    "CD14"    "S100A8"  "S100A9"  "LYZ"</span></span></code></pre>
<p>If you want to retrieve the top loading genes for all factors within
given reduction you can set <code>factor = "all"</code> and the function
will return data.frame with one column per factor.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top_10_factor_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Top_Genes_Factor.html">Top_Genes_Factor</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">pbmc</span>, factor <span class="op">=</span> <span class="st">"all"</span>, reduction <span class="op">=</span> <span class="st">"cnmf"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">top_10_factor_df</span>, <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<table class="table table table-bordered table-condensed table-responsive table-striped" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Factor_1
</th>
<th style="text-align:left;">
Factor_2
</th>
<th style="text-align:left;">
Factor_3
</th>
<th style="text-align:left;">
Factor_4
</th>
<th style="text-align:left;">
Factor_5
</th>
<th style="text-align:left;">
Factor_6
</th>
<th style="text-align:left;">
Factor_7
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
HLA-DRB1
</td>
<td style="text-align:left;">
LGALS1
</td>
<td style="text-align:left;">
HLA-DPA1
</td>
<td style="text-align:left;">
CLIC3
</td>
<td style="text-align:left;">
AIF1
</td>
<td style="text-align:left;">
BLM
</td>
<td style="text-align:left;">
PRUNE
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
CYBA
</td>
<td style="text-align:left;">
GSTP1
</td>
<td style="text-align:left;">
MS4A1
</td>
<td style="text-align:left;">
CTSW
</td>
<td style="text-align:left;">
RHOC
</td>
<td style="text-align:left;">
BIRC5
</td>
<td style="text-align:left;">
ESAM
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
RPS27A
</td>
<td style="text-align:left;">
LGALS2
</td>
<td style="text-align:left;">
HLA-DQA2
</td>
<td style="text-align:left;">
CST7
</td>
<td style="text-align:left;">
COTL1
</td>
<td style="text-align:left;">
KIFC1
</td>
<td style="text-align:left;">
MMD
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
RPS6
</td>
<td style="text-align:left;">
TYROBP
</td>
<td style="text-align:left;">
CD79B
</td>
<td style="text-align:left;">
SPON2
</td>
<td style="text-align:left;">
IFITM2
</td>
<td style="text-align:left;">
TK1
</td>
<td style="text-align:left;">
PTCRA
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
RPL31
</td>
<td style="text-align:left;">
FCN1
</td>
<td style="text-align:left;">
HLA-DRB1
</td>
<td style="text-align:left;">
FGFBP2
</td>
<td style="text-align:left;">
IFITM3
</td>
<td style="text-align:left;">
CDC20
</td>
<td style="text-align:left;">
ACRBP
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
RPS15A
</td>
<td style="text-align:left;">
CST3
</td>
<td style="text-align:left;">
HLA-DPB1
</td>
<td style="text-align:left;">
GNLY
</td>
<td style="text-align:left;">
MS4A7
</td>
<td style="text-align:left;">
KIAA0101
</td>
<td style="text-align:left;">
LGALSL
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
EEF1A1
</td>
<td style="text-align:left;">
CD14
</td>
<td style="text-align:left;">
HLA-DQA1
</td>
<td style="text-align:left;">
GZMA
</td>
<td style="text-align:left;">
RP11-290F20.3
</td>
<td style="text-align:left;">
TYMS
</td>
<td style="text-align:left;">
AC147651.3
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:left;">
RPS25
</td>
<td style="text-align:left;">
S100A8
</td>
<td style="text-align:left;">
HLA-DQB1
</td>
<td style="text-align:left;">
GZMB
</td>
<td style="text-align:left;">
LST1
</td>
<td style="text-align:left;">
MCM10
</td>
<td style="text-align:left;">
HIST1H2AC
</td>
</tr>
<tr>
<td style="text-align:left;">
9
</td>
<td style="text-align:left;">
RPS27
</td>
<td style="text-align:left;">
S100A9
</td>
<td style="text-align:left;">
HLA-DRA
</td>
<td style="text-align:left;">
PRF1
</td>
<td style="text-align:left;">
FCER1G
</td>
<td style="text-align:left;">
CDC6
</td>
<td style="text-align:left;">
TSC22D1
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
RPS12
</td>
<td style="text-align:left;">
LYZ
</td>
<td style="text-align:left;">
CD74
</td>
<td style="text-align:left;">
NKG7
</td>
<td style="text-align:left;">
FCGR3A
</td>
<td style="text-align:left;">
RRM2
</td>
<td style="text-align:left;">
C2orf88
</td>
</tr>
</tbody>
</table>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Samuel Marsh.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
