<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Add Multiple Cell Quality Control Values with Single Function — Add_Cell_QC_Metrics • scCustomize</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Add Multiple Cell Quality Control Values with Single Function — Add_Cell_QC_Metrics"><meta property="og:description" content="Add Mito/Ribo %, Cell Complexity (log10GenesPerUMI), Top Gene Percent with single
function call to Seurat or liger objects."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scCustomize</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">Getting Started</a>
</li>
<li>
  <a href="../articles/Installation.html">Install</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">Plotting Vignettes</li>
    <li>
      <a href="../articles/Gene_Expression_Plotting.html">Plotting #1: General Analysis Plots</a>
    </li>
    <li>
      <a href="../articles/QC_Plots.html">Plotting #2: QC Plots &amp; Analysis</a>
    </li>
    <li>
      <a href="../articles/Sequencing_QC_Plots.html">Plotting #3: Sequencing QC Plots/Analysis</a>
    </li>
    <li>
      <a href="../articles/Iterative_Plotting.html">Plotting #4: Iterative Plotting Functions</a>
    </li>
    <li>
      <a href="../articles/Spatial_Plotting.html">Plotting #5: Spatial Plotting Functions</a>
    </li>
    <li>
      <a href="../articles/Color_Palettes.html">Customized Color Palettes &amp; Themes</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Helpers &amp; Utilities</li>
    <li>
      <a href="../articles/Helpers_and_Utilities.html">General Helpers &amp; Utilities</a>
    </li>
    <li>
      <a href="../articles/Object_QC_Functions.html">Object QC Functions</a>
    </li>
    <li>
      <a href="../articles/Read_and_Write_Functions.html">Read &amp; Write Data Functions</a>
    </li>
    <li>
      <a href="../articles/Object_Conversion.html">Object/Assay Format Conversion</a>
    </li>
    <li>
      <a href="../articles/Markers_and_Cluster_Annotation.html">Marker Identification &amp; Cluster Annotation Helpers</a>
    </li>
    <li>
      <a href="../articles/Statistics.html">Statistics Functions</a>
    </li>
    <li>
      <a href="../articles/Update_Gene_Symbols.html">Updating Gene Symbols</a>
    </li>
    <li>
      <a href="../articles/Misc_Functions.html">Misc Functions</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Other Package Interactivity/Functions</li>
    <li>
      <a href="../articles/LIGER_Functions.html">LIGER Plotting &amp; Functionality</a>
    </li>
    <li>
      <a href="../articles/Cell_Bender_Functions.html">Cell Bender Functionality &amp; Plotting</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">News/Changelog</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/FAQ.html">FAQ</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/samuel-marsh/scCustomize/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Add Multiple Cell Quality Control Values with Single Function</h1>
    <small class="dont-index">Source: <a href="https://github.com/samuel-marsh/scCustomize/blob/HEAD/R/Generics.R" class="external-link"><code>R/Generics.R</code></a>, <a href="https://github.com/samuel-marsh/scCustomize/blob/HEAD/R/LIGER_Utilities.R" class="external-link"><code>R/LIGER_Utilities.R</code></a>, <a href="https://github.com/samuel-marsh/scCustomize/blob/HEAD/R/QC_Utilities_Seurat.R" class="external-link"><code>R/QC_Utilities_Seurat.R</code></a></small>
    <div class="hidden name"><code>Add_Cell_QC_Metrics.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Add Mito/Ribo %, Cell Complexity (log10GenesPerUMI), Top Gene Percent with single
function call to Seurat or liger objects.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Add_Cell_QC_Metrics</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for liger</span></span>
<span><span class="fu">Add_Cell_QC_Metrics</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  add_mito_ribo <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  add_complexity <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  add_top_pct <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  add_MSigDB <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  add_IEG <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  add_hemo <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  add_lncRNA <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  add_cell_cycle <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">species</span>,</span>
<span>  mito_name <span class="op">=</span> <span class="st">"percent_mito"</span>,</span>
<span>  ribo_name <span class="op">=</span> <span class="st">"percent_ribo"</span>,</span>
<span>  mito_ribo_name <span class="op">=</span> <span class="st">"percent_mito_ribo"</span>,</span>
<span>  complexity_name <span class="op">=</span> <span class="st">"log10GenesPerUMI"</span>,</span>
<span>  top_pct_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  oxphos_name <span class="op">=</span> <span class="st">"percent_oxphos"</span>,</span>
<span>  apop_name <span class="op">=</span> <span class="st">"percent_apop"</span>,</span>
<span>  dna_repair_name <span class="op">=</span> <span class="st">"percent_dna_repair"</span>,</span>
<span>  ieg_name <span class="op">=</span> <span class="st">"percent_ieg"</span>,</span>
<span>  hemo_name <span class="op">=</span> <span class="st">"percent_hemo"</span>,</span>
<span>  lncRNA_name <span class="op">=</span> <span class="st">"percent_lncRNA"</span>,</span>
<span>  mito_pattern <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ribo_pattern <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hemo_pattern <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mito_features <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ribo_features <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hemo_features <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ensembl_ids <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  num_top_genes <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  assay <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  list_species_names <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for Seurat</span></span>
<span><span class="fu">Add_Cell_QC_Metrics</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">species</span>,</span>
<span>  add_mito_ribo <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  add_complexity <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  add_top_pct <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  add_MSigDB <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  add_IEG <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  add_IEG_module_score <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  add_hemo <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  add_lncRNA <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  add_cell_cycle <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  mito_name <span class="op">=</span> <span class="st">"percent_mito"</span>,</span>
<span>  ribo_name <span class="op">=</span> <span class="st">"percent_ribo"</span>,</span>
<span>  mito_ribo_name <span class="op">=</span> <span class="st">"percent_mito_ribo"</span>,</span>
<span>  complexity_name <span class="op">=</span> <span class="st">"log10GenesPerUMI"</span>,</span>
<span>  top_pct_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  oxphos_name <span class="op">=</span> <span class="st">"percent_oxphos"</span>,</span>
<span>  apop_name <span class="op">=</span> <span class="st">"percent_apop"</span>,</span>
<span>  dna_repair_name <span class="op">=</span> <span class="st">"percent_dna_repair"</span>,</span>
<span>  ieg_name <span class="op">=</span> <span class="st">"percent_ieg"</span>,</span>
<span>  ieg_module_name <span class="op">=</span> <span class="st">"ieg_score"</span>,</span>
<span>  hemo_name <span class="op">=</span> <span class="st">"percent_hemo"</span>,</span>
<span>  lncRNA_name <span class="op">=</span> <span class="st">"percent_lncRNA"</span>,</span>
<span>  mito_pattern <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ribo_pattern <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hemo_pattern <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mito_features <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ribo_features <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hemo_features <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ensembl_ids <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  num_top_genes <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  assay <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  list_species_names <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>Seurat or LIGER object</p></dd>


<dt>...</dt>
<dd><p>Arguments passed to other methods</p></dd>


<dt>add_mito_ribo</dt>
<dd><p>logical, whether to add percentage of counts belonging to mitochondrial/ribosomal
genes to object (Default is TRUE).</p></dd>


<dt>add_complexity</dt>
<dd><p>logical, whether to add Cell Complexity to object (Default is TRUE).</p></dd>


<dt>add_top_pct</dt>
<dd><p>logical, whether to add Top Gene Percentages to object (Default is TRUE).</p></dd>


<dt>add_MSigDB</dt>
<dd><p>logical, whether to add percentages of counts belonging to genes from of mSigDB hallmark
gene lists: "HALLMARK_OXIDATIVE_PHOSPHORYLATION", "HALLMARK_APOPTOSIS", and "HALLMARK_DNA_REPAIR" to
object (Default is TRUE).</p></dd>


<dt>add_IEG</dt>
<dd><p>logical, whether to add percentage of counts belonging to IEG genes to object (Default is TRUE).</p></dd>


<dt>add_hemo</dt>
<dd><p>logical, whether to add percentage of counts belonging to homoglobin genes to object (Default is TRUE).</p></dd>


<dt>add_lncRNA</dt>
<dd><p>logical, whether to add percentage of counts belonging to lncRNA genes to object (Default is TRUE).</p></dd>


<dt>add_cell_cycle</dt>
<dd><p>logical, whether to addcell cycle scores and phase based on
<code><a href="https://satijalab.org/seurat/reference/CellCycleScoring.html" class="external-link">CellCycleScoring</a></code>.  Only applicable if <code>species = "human"</code>.  (Default is TRUE).</p></dd>


<dt>species</dt>
<dd><p>Species of origin for given Seurat Object.  If mouse, human, marmoset, zebrafish, rat,
drosophila, rhesus macaque, or chicken (name or abbreviation) are provided the function will automatically
generate patterns and features.</p></dd>


<dt>mito_name</dt>
<dd><p>name to use for the new meta.data column containing percent mitochondrial counts.
Default is "percent_mito".</p></dd>


<dt>ribo_name</dt>
<dd><p>name to use for the new meta.data column containing percent ribosomal counts.
Default is "percent_ribo".</p></dd>


<dt>mito_ribo_name</dt>
<dd><p>name to use for the new meta.data column containing percent
mitochondrial+ribosomal counts.  Default is "percent_mito_ribo".</p></dd>


<dt>complexity_name</dt>
<dd><p>name to use for new meta data column for <code>Add_Cell_Complexity</code>.
Default is "log10GenesPerUMI".</p></dd>


<dt>top_pct_name</dt>
<dd><p>name to use for new meta data column for <code>Add_Top_Gene_Pct</code>.
Default is "percent_topXX", where XX is equal to the value provided to <code>num_top_genes</code>.</p></dd>


<dt>oxphos_name</dt>
<dd><p>name to use for new meta data column for percentage of MSigDB oxidative phosphorylation
counts.  Default is "percent_oxphos".</p></dd>


<dt>apop_name</dt>
<dd><p>name to use for new meta data column for percentage of MSigDB apoptosis counts.
Default is "percent_apop".</p></dd>


<dt>dna_repair_name</dt>
<dd><p>name to use for new meta data column for percentage of MSigDB DNA repair
counts.  Default is "percent_dna_repair"..</p></dd>


<dt>ieg_name</dt>
<dd><p>name to use for new meta data column for percentage of IEG counts.  Default is "percent_ieg".</p></dd>


<dt>hemo_name</dt>
<dd><p>name to use for the new meta.data column containing percent hemoglobin counts.
Default is "percent_mito".</p></dd>


<dt>lncRNA_name</dt>
<dd><p>name to use for the new meta.data column containing percent lncRNA counts.
Default is "percent_lncRNA".</p></dd>


<dt>mito_pattern</dt>
<dd><p>A regex pattern to match features against for mitochondrial genes (will set automatically if
species is mouse or human; marmoset features list saved separately).</p></dd>


<dt>ribo_pattern</dt>
<dd><p>A regex pattern to match features against for ribosomal genes
(will set automatically if species is in default list).</p></dd>


<dt>hemo_pattern</dt>
<dd><p>A regex pattern to match features against for hemoglobin genes
(will set automatically if species is in default list).</p></dd>


<dt>mito_features</dt>
<dd><p>A list of mitochondrial gene names to be used instead of using regex pattern.
Will override regex pattern if both are present (including default saved regex patterns).</p></dd>


<dt>ribo_features</dt>
<dd><p>A list of ribosomal gene names to be used instead of using regex pattern.
Will override regex pattern if both are present (including default saved regex patterns).</p></dd>


<dt>hemo_features</dt>
<dd><p>A list of hemoglobin gene names to be used instead of using regex pattern.
Will override regex pattern if both are present (including default saved regex patterns).</p></dd>


<dt>ensembl_ids</dt>
<dd><p>logical, whether feature names in the object are gene names or
ensembl IDs (default is FALSE; set TRUE if feature names are ensembl IDs).</p></dd>


<dt>num_top_genes</dt>
<dd><p>An integer vector specifying the size(s) of the top set of high-abundance genes.
Used to compute the percentage of library size occupied by the most highly expressed genes in each cell.</p></dd>


<dt>assay</dt>
<dd><p>assay to use in calculation.  Default is "RNA".  <em>Note</em> This should only be changed if
storing corrected and uncorrected assays in same object (e.g. outputs of both Cell Ranger and Cell Bender).</p></dd>


<dt>list_species_names</dt>
<dd><p>returns list of all accepted values to use for default species names which
contain internal regex/feature lists (human, mouse, marmoset, zebrafish, rat, drosophila, rhesus macaque, and
chicken).  Default is FALSE.</p></dd>


<dt>overwrite</dt>
<dd><p>Logical.  Whether to overwrite existing an meta.data column.  Default is FALSE meaning that
function will abort if column with name provided to <code>meta_col_name</code> is present in meta.data slot.</p></dd>


<dt>add_IEG_module_score</dt>
<dd><p>logical, whether to add module score belonging to IEG genes to object (Default is TRUE).</p></dd>


<dt>ieg_module_name</dt>
<dd><p>name to use for new meta data column for module score of IEGs.  Default is "ieg_score".</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A liger Object</p>


<p>A Seurat Object</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu">Add_Cell_QC_Metrics</span><span class="op">(</span>object <span class="op">=</span> <span class="va">obj</span>, species <span class="op">=</span> <span class="st">"Human"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu">Add_Cell_QC_Metrics</span><span class="op">(</span>object <span class="op">=</span> <span class="va">obj</span>, species <span class="op">=</span> <span class="st">"Human"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Samuel Marsh.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

