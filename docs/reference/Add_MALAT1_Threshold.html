<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Add MALAT1 QC Threshold — Add_MALAT1_Threshold • scCustomize</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Add MALAT1 QC Threshold — Add_MALAT1_Threshold"><meta property="og:description" content="Adds TRUE/FALSE values to each cell based on calculation of MALAT1 threshold.
This function incorporates a threshold calculation and procedure as described in
Clarke &amp;amp; Bader (2024). bioRxiv doi:10.1101/2024.07.14.603469
.  Please cite this preprint
whenever using this function."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scCustomize</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">Getting Started</a>
</li>
<li>
  <a href="../articles/Installation.html">Install</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">Plotting Vignettes</li>
    <li>
      <a href="../articles/Gene_Expression_Plotting.html">Plotting #1: General Analysis Plots</a>
    </li>
    <li>
      <a href="../articles/QC_Plots.html">Plotting #2: QC Plots &amp; Analysis</a>
    </li>
    <li>
      <a href="../articles/Sequencing_QC_Plots.html">Plotting #3: Sequencing QC Plots/Analysis</a>
    </li>
    <li>
      <a href="../articles/Iterative_Plotting.html">Plotting #4: Iterative Plotting Functions</a>
    </li>
    <li>
      <a href="../articles/Spatial_Plotting.html">Plotting #5: Spatial Plotting Functions</a>
    </li>
    <li>
      <a href="../articles/Color_Palettes.html">Customized Color Palettes &amp; Themes</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Helpers &amp; Utilities</li>
    <li>
      <a href="../articles/Helpers_and_Utilities.html">General Helpers &amp; Utilities</a>
    </li>
    <li>
      <a href="../articles/Object_QC_Functions.html">Object QC Functions</a>
    </li>
    <li>
      <a href="../articles/Read_and_Write_Functions.html">Read &amp; Write Data Functions</a>
    </li>
    <li>
      <a href="../articles/Object_Conversion.html">Object/Assay Format Conversion</a>
    </li>
    <li>
      <a href="../articles/Markers_and_Cluster_Annotation.html">Marker Identification &amp; Cluster Annotation Helpers</a>
    </li>
    <li>
      <a href="../articles/Statistics.html">Statistics Functions</a>
    </li>
    <li>
      <a href="../articles/Update_Gene_Symbols.html">Updating Gene Symbols</a>
    </li>
    <li>
      <a href="../articles/Misc_Functions.html">Misc Functions</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Other Package Interactivity/Functions</li>
    <li>
      <a href="../articles/LIGER_Functions.html">LIGER Plotting &amp; Functionality</a>
    </li>
    <li>
      <a href="../articles/Cell_Bender_Functions.html">Cell Bender Functionality &amp; Plotting</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">News/Changelog</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/FAQ.html">FAQ</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/samuel-marsh/scCustomize/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Add MALAT1 QC Threshold</h1>
    <small class="dont-index">Source: <a href="https://github.com/samuel-marsh/scCustomize/blob/HEAD/R/Generics.R" class="external-link"><code>R/Generics.R</code></a>, <a href="https://github.com/samuel-marsh/scCustomize/blob/HEAD/R/QC_Utilities_Seurat.R" class="external-link"><code>R/QC_Utilities_Seurat.R</code></a></small>
    <div class="hidden name"><code>Add_MALAT1_Threshold.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Adds TRUE/FALSE values to each cell based on calculation of MALAT1 threshold.
This function incorporates a threshold calculation and procedure as described in
Clarke &amp; Bader (2024). bioRxiv <a href="https://doi.org/10.1101/2024.07.14.603469" class="external-link">doi:10.1101/2024.07.14.603469</a>
.  Please cite this preprint
whenever using this function.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Add_MALAT1_Threshold</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for Seurat</span></span>
<span><span class="fu">Add_MALAT1_Threshold</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">species</span>,</span>
<span>  sample_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  malat1_threshold_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ensembl_ids <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  assay <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  print_plots <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  save_plots <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  save_plot_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  save_plot_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plot_width <span class="op">=</span> <span class="fl">11</span>,</span>
<span>  plot_height <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  whole_object <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  homolog_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bw <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  breaks <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  chosen_min <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  smooth <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  abs_min <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  rough_max <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>Seurat or LIGER object</p></dd>


<dt>...</dt>
<dd><p>Arguments passed to other methods</p></dd>


<dt>species</dt>
<dd><p>Species of origin for given Seurat Object.  Only accepted species are: mouse, human (name or abbreviation).</p></dd>


<dt>sample_col</dt>
<dd><p>column name in meta.data that contains sample ID information.</p></dd>


<dt>malat1_threshold_name</dt>
<dd><p>name to use for the new meta.data column containing percent IEG gene counts.
Default is set dependent on species gene symbol.</p></dd>


<dt>ensembl_ids</dt>
<dd><p>logical, whether feature names in the object are gene names or
ensembl IDs (default is FALSE; set TRUE if feature names are ensembl IDs).</p></dd>


<dt>assay</dt>
<dd><p>Assay to use (default is the current object default assay).</p></dd>


<dt>overwrite</dt>
<dd><p>Logical.  Whether to overwrite existing meta.data columns.  Default is FALSE meaning that
function will abort if columns with the name provided to <code>malat1_threshold_name</code> is present in meta.data slot.</p></dd>


<dt>print_plots</dt>
<dd><p>logical, should plots be printed to output when running function (default is NULL).
Will automatically set to FALSE if performing across samples or TRUE if performing across whole object.</p></dd>


<dt>save_plots</dt>
<dd><p>logical, whether or not to save plots to pdf (default is FALSE).</p></dd>


<dt>save_plot_path</dt>
<dd><p>path to save location for plots (default is NULL; current working directory).</p></dd>


<dt>save_plot_name</dt>
<dd><p>name for pdf file containing plots.</p></dd>


<dt>plot_width</dt>
<dd><p>the width (in inches) for output page size.  Default is 11.</p></dd>


<dt>plot_height</dt>
<dd><p>the height (in inches) for output page size.  Default is 8.</p></dd>


<dt>whole_object</dt>
<dd><p>logical, whether to perform calculation on whole object (default is FALSE).
Should be only be run if object contains single sample.</p></dd>


<dt>homolog_name</dt>
<dd><p>feature name for MALAT1 homolog in non-default species (if annotated).</p></dd>


<dt>bw</dt>
<dd><p>The "bandwidth" value when plotting the density function to the MALAT1 distribution;
default is bw = 0.1, but this parameter should be lowered (e.g. to 0.01) if you run the function and
the line that's produced doesn't look like it's tracing the shape of the histogram accurately (this will
make the line less "stiff" and more fitted to the data)</p></dd>


<dt>lwd</dt>
<dd><p>The "line width" fed to the abline function which adds the vertical red line to the output plots;
default is 2, and it can be increased or decreased depending on the user's plotting preferences</p></dd>


<dt>breaks</dt>
<dd><p>The number of bins used for plotting the histogram of normalized MALAT1 values; default is 100</p></dd>


<dt>chosen_min</dt>
<dd><p>The minimum MALAT1 value cutoff above which a MALAT1 peak in the density function should
be found. This value is necessary to determine which peak in the density function fitted to the MALAT1
distribution is likely representative of what we would expect to find in real cells. This is because
some samples may have large numbers of cells or empty droplets with lower than expected normalized MALAT1 values,
and therefore have a peak close to or at zero. Ideally, "chosen_min" would be manually chosen after looking at
a histogram of MALAT1 values, and be the normalized MALAT1 value that cuts out all of the cells that look like
they stray from the expected distribution (a unimodal distribution above zero). The default value is 1 as this
works well in many test cases, but different types of normalization may make the user want to change this
parameter (e.g. Seurat's original normalization function generates different results to their SCT function)
which may change the MALAT1 distribution). Increase or decrease chosen_min depending on where your MALAT1 peak is located.</p></dd>


<dt>smooth</dt>
<dd><p>The "smoothing parameter" fed into the "smooth.spline" function that adjusts the trade-off between
the smoothness of the line fitting the histogram, and how closely it fits the histogram; the default is 1,
and can be lowered if it looks like the line is underfitting the data, and raised in the case of overfitting.
The ideal scenario is for the line to trace the histogram in a way where the only inflection point(s) are between
major peaks, e.g. separating the group of poor-quality cells or empty droplets with lower normalized MALAT1
expression from higher-quality cells with higher normalized MALAT1 expression.</p></dd>


<dt>abs_min</dt>
<dd><p>The absolute lowest value allowed as the MALAT1 threshold. This parameter increases the
robustness of the function if working with an outlier data distribution (e.g. an entire sample is poor
quality so there is a unimodal MALAT1 distribution that is very low but above zero, but also many
values close to zero) and prevents a resulting MALAT1 threshold of zero. In the case where a calculated
MALAT1 value is zero, the function will return 0.3 by default.</p></dd>


<dt>rough_max</dt>
<dd><p>A rough value for the location of a MALAT1 peak if a peak is not found. This is possible
if there are so few cells with higher MALAT1 values, that a distribution fitted to the data finds no local maxima.
For example, if a sample only has poor-quality cells such that all have near-zero MALAT1 expression,
the fitted function may look similar to a positive quadratic function which has no local maxima.
In this case, the function searches for the closest MALAT1 value to the default value, 2, to use in place of
a real local maximum.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Seurat object with added meta.data column</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>This function incorporates a threshold calculation and procedure as described in
Clarke &amp; Bader (2024). bioRxiv <a href="https://doi.org/10.1101/2024.07.14.603469" class="external-link">doi:10.1101/2024.07.14.603469</a>
.  Please cite this preprint
whenever using this function.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Zoe Clark (original function and manuscript) &amp; Samuel Marsh (wrappers and updates for inclusion in package)</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu">Add_MALAT1_Threshold</span><span class="op">(</span>object <span class="op">=</span> <span class="va">object</span>, species <span class="op">=</span> <span class="st">"Human"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Samuel Marsh.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

